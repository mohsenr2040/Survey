<!DOCTYPE html>
<html lang="en">

@using Staff_Survey.ViewModel;
@model SurveyViewModel
@{

}
<head>

    <title>
        نظرسنجی
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width" />



    <style>
        /* Styling the Body element
                                        i.e. Color, Font, Alignment */
        body {
            background-color: #A4d6b9;
            font-family: 'B Nazanin';
            text-align: right;
        }

        /* Styling the Form (Color, Padding, Shadow) */
        form {
            background-color: #fff;
            max-width: 85%;
            margin: 30px auto;
            padding: 30px 20px;
            box-shadow: 2px 5px 10px rgba(0, 0, 0, 0.5);
            text-align: right;
        }

        /* Styling form-control Class */
        .form-control {
            margin-bottom: 25px;
            font-family: 'B Nazanin';
            text-align: right;
        }

            /* Styling form-control Label */
            .form-control label {
                display: block;
                margin-bottom: 10px;
            }

            /* Styling form-control input,
                                        select, textarea */
            .form-control input,
            .form-control select,
            .form-control textarea {
                border: 1px solid #777;
                border-radius: 2px;
                font-family: inherit;
                padding: 10px;
                display: block;
                width: 95%;
                text-align: right;
            }

                /* Styling form-control Radio
                                        button and Checkbox */
                .form-control input[type="radio"],
                .form-control input[type="checkbox"] {
                    display: inline-block;
                    width: auto;
                }


        /* Styling Button */
        button {
            background-color: #05c46b;
            border: 1px solid #777;
            border-radius: 2px;
            font-family: inherit;
            font-size: 21px;
            display: block;
            width: 100%;
            margin-top: 50px;
            margin-bottom: 20px;
        }

        .a-button {
            background-color: #05c46b;
            border: 1px solid #777;
            border-radius: 2px;
            font-family: inherit;
            font-size: 21px;
            display: block;
            width: 100%;
            margin-top: 50px;
            margin-bottom: 20px;
            text-align: center;
        }

        .a-button-menu {
            background-color: #D4DCE0;
            border: 1px solid #777;
            border-radius: 2px;
            font-family: inherit;
            font-size: 21px;
            display: block;
            width: 20%;
            margin: 20px auto;
            text-align: center;
            text-decoration: none;
            vartical-align: middle;
        }

        

       .topnav {
              overflow: hidden;
               border: 1px solid green;
              background-color: #bcd4e3;
              text-align:right;
            }

            .topnav a {
              float: right;
              color: #010001;
              text-align: center;
              padding: 14px 16px;
              text-decoration: none;
              font-size: 17px;
            }

            .topnav a:hover {
              background-color: #ddd;
              color: black;
            }

            .topnav a.active {
              background-color: #04AA6D;
              color: white;
            }
             .username
            {
              float: right;
              color: #010001;
              text-align: center;
              padding: 14px 16px;
              text-decoration: none;
              font-size: 17px;
            }
        
    </style>




</head>


<body style="font-family:'B Nazanin'; text-align:right" dir="rtl">

   <h1 style="text-align:center"> نظرسنجی</h1>

 
            <div class="topnav"  dir="rtl">
              <a  href="~/home/index" dir="rtl">نظرسنجی ها</a>
              <a href="~/survey/CreateSurvey" dir="rtl">مدیر سیستم</a>
        <a href="~/Signout" style="text-decoration:none;color:#db0001">
            @* <img style="width:30px;height:30px" src="~/Login/logout.png" > *@
            خروج
        </a>
           
              <span class="username"> @User.Claims.Where(c => c.Type == "FullName").FirstOrDefault().Value </span>
            </div>

    <form id="form1" dir="rtl">
         

        <label for="basicSelect" style="font-size: 20px;"> @Model.Survey.name </label>


        @foreach (var question in Model.Survey.Questions)
        {
            <div style="border: 1px solid #564040; margin: 10px auto; border-radius: 12.5px;padding: 10px;">
                <label for="basicSelect">  @question.Question </label>
                <table id="tbl_" style="width:100%">

                    <tr>
                        @foreach (var item in @question.Items)
                        {
                            <td>
                                <input type="radio" name=@question.QuestionId value=@item.ItemId>
                                <label>@item.ItemValue</label>
                            </td>
                        }
                    </tr>
                </table>

            </div>
        }

        <div style="text-align:center;width:50%">
            <a class="a-button" style="width:100%" onclick="RegisterUserSurvey()"> ثبت </a>

        </div>
    </form>

    <!-- Create Form -->


</body>


</html>

<script src="~/app-assets/vendors/js/core/jquery-3.3.1.min.js"></script>
<script src="~/app-assets/js/persian-datepicker.min.js"></script>
<script src="~/app-assets/vendors/js/core/popper.min.js"></script>
<script src="~/app-assets/vendors/js/core/bootstrap.min.js"></script>
<script src="~/app-assets/vendors/js/perfect-scrollbar.jquery.min.js"></script>
<script src="~/app-assets/vendors/js/prism.min.js"></script>
<script src="~/app-assets/vendors/js/jquery.matchHeight-min.js"></script>
<script src="~/app-assets/vendors/js/screenfull.min.js"></script>
<script src="~/app-assets/vendors/js/pace/pace.min.js"></script>
<!-- BEGIN VENDOR JS-->
<!-- BEGIN PAGE VENDOR JS-->
<!-- END PAGE VENDOR JS-->
<!-- BEGIN CONVEX JS-->
<script src="~/app-assets/js/app-sidebar.js"></script>
<script src="~/app-assets/js/notification-sidebar.js"></script>
<script src="~/app-assets/js/customizer.js"></script>

<link href="~/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<script src="~/Sweetalert2/sweetalert2.min.js"></script>
<script>

    function RegisterUserSurvey() {

       
        var data = new FormData();
        
        //var $inputs = $('#form1 :input[type="radio"]');

        var questionItems = $('#form1 :input[type="radio"]').map(function () {
            if ($(this).is(":checked"))
                return {
                itemId: $(this).val(),
            };
        }).get();

        // $inputs.each(function (i) {
        //     if ($(this).is(":checked")) {
        //         postData.append('[' + i + '].itemId', $(this).val());
        //     }
        // });

        $.each(questionItems, function (i, val) {
            data.append('[' + i + '].itemId', val.itemId);
        });

        var urlparam=window.location.href.split('?')[1];
        data.append("surveyId",urlparam.split('=')[1] );
      
        // for (var pair of data.entries()) {
        //     alert(pair);
        // }
        var ajaxRequest = $.ajax({
            type: "POST",
            url: "Survey", 
            contentType: false,
            processData: false,
            data: data,
            success: function (data) {
                if (data.isSuccess == true) {

                    swal.fire(
                        'موفق!',
                        data.message,
                        'success'
                    ).then(function (isConfirm) {
                       location.reload();

                    });
                }
                else {

                    swal.fire(
                        'هشدار!',
                        data.message,
                        'warning'
                    );
                }

            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                alert(thrownError);
            }

        });

        ajaxRequest.done(function (xhr, textStatus) {
            // Do other operation
        });
        }


</script>